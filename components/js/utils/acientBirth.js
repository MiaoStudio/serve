
import moment from 'moment'


const tg=new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸");
const dz=new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥");
const sx=new Array("鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪");
const w=new Array("木","火","土","金","水");
const f=new Array("东","南","中","西","北");
const sz=new Array("一","二","三","四","五","六","七","八","九","十",
"十一","十二","十三","十四","十五","十六","十七","十八","十九","二十",
"廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十");
const m0=new Array(
0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,//1901
0,1,0,1,2,1,0,0,1,1,0,1,1,1,0,1,0,0,1,0,0,1,1,0,
1,1,0,1,1,0,0,1,0,1,0,1,0,1,1,3,0,1,0,1,0,1,0,1,
0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,1,0,1,0,1,1,0,1,
0,4,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,0,3632)
const m1=new Array(
1,0,1,0,0,4,0,1,1,0,1,1,1,0,1,0,0,1,0,0,1,1,0,1,//1911
1,1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,3,0,1,0,0,1,0,1,
1,0,1,1,0,1,0,1,0,1,0,0,1,1,0,1,0,1,1,0,1,0,1,0,
1,2,1,0,1,1,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,1,
0,1,0,0,1,0,3,1,0,1,1,1,0,1,0,0,1,0,0,1,0,1,1,1,7294)
const m2=new Array(
1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,2,1,0,0,1,0,1,1,//1921
0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,0,1,0,0,
1,0,1,3,1,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,1,0,
1,0,0,1,0,1,0,1,0,1,1,1,0,4,0,1,0,0,1,0,1,1,1,1,
0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,4,0,1,0,1,1,0,10955);
const m3=new Array(
1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,//1931
0,1,1,0,5,0,1,0,1,0,0,1,0,1,0,1,1,0,1,0,1,1,0,1,
0,0,1,0,1,0,1,1,0,1,1,0,1,0,3,0,0,1,1,0,1,1,1,0,
1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,3,0,1,1,0,1,
1,1,0,0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,14587);
const m4=new Array(
1,1,0,1,1,3,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,//1941
0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,3,0,1,0,1,1,0,1,1,
0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,
1,4,0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,
1,0,1,1,0,1,2,1,0,1,0,1,0,1,1,0,1,1,0,0,1,0,1,0,18249);
const m5=new Array(
1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,3,0,1,1,0,1,0,1,//1951
0,1,0,0,1,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,
0,1,3,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,
1,0,1,0,1,0,0,4,1,0,1,0,1,1,1,0,1,0,0,1,0,1,0,1,
0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,4,1,0,1,0,1,0,21911);
const m6=new Array(
1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,0,//1961
1,0,1,2,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,
0,1,0,1,0,0,1,0,0,1,1,0,1,1,4,1,0,0,1,0,0,1,1,0,
1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,1,0,4,1,0,1,0,1,
0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,0,1,25544);
const m7=new Array(
0,1,0,0,4,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,//1971
1,0,1,0,0,1,0,0,1,1,0,1,1,1,0,4,0,1,0,0,1,1,0,1,
1,1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,0,1,0,4,0,1,0,1,
1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,0,1,0,1,0,
1,0,0,1,0,5,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,1,29206);
const m8=new Array(
0,1,0,0,1,0,0,1,1,0,1,1,1,0,1,2,1,0,0,1,0,1,1,1,//1981
1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,0,4,1,1,
0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,0,1,0,0,
1,0,1,0,1,4,1,1,0,1,0,0,1,0,1,0,1,0,1,1,0,1,1,0,
1,0,0,1,0,1,0,1,0,1,1,1,0,1,0,0,4,0,1,0,1,1,1,1,32868);
const m9=new Array(
0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,0,1,0,1,1,//1991
0,1,4,1,0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,
0,1,1,0,1,0,1,4,0,1,0,1,0,1,0,1,1,0,1,0,1,1,0,0,
1,0,1,0,1,0,1,1,0,1,1,0,1,0,0,1,2,1,1,0,1,1,0,1,
1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,36499);
const m10=new Array(
1,1,0,4,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,//2001
1,1,0,1,1,0,1,0,0,1,0,1,0,4,1,1,0,1,0,1,0,1,0,1,
0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,4,1,1,0,1,1,
0,0,1,0,0,1,0,1,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,
1,1,0,0,4,0,1,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,40161);
const m11=new Array(
1,0,1,1,0,1,0,0,1,0,1,0,1,0,1,4,1,0,1,0,1,0,1,0,//2011
1,0,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,4,1,0,1,
0,1,0,0,1,0,1,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,
0,1,0,1,0,3,0,1,0,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,
1,0,1,0,1,0,0,1,0,0,1,1,0,1,1,4,1,0,0,1,0,1,0,1,43823);
const m12=new Array(
0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,//2021
0,4,0,1,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,0,
1,0,1,0,0,4,1,0,1,1,1,0,1,0,1,0,0,1,0,0,1,1,1,0,
1,1,0,1,0,0,1,0,0,1,1,0,1,1,1,0,4,0,1,0,0,1,1,0,
1,1,0,1,0,1,0,1,0,0,1,1,0,1,0,1,1,0,1,0,1,0,1,0,47455)
const m13=new Array(
0,1,4,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,1,0,1,//2031
0,1,0,0,1,0,1,0,1,1,4,1,0,1,0,0,1,0,1,0,1,1,0,1,
1,0,1,0,0,1,0,0,1,1,0,1,1,1,0,1,0,3,0,0,1,0,1,1,
1,1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,0,1,0,1,0,1,0,0,
1,1,0,1,4,1,0,1,0,1,0,0,1,0,1,1,0,1,0,1,1,0,1,0,51117)
const m14=new Array(
0,1,0,1,0,1,1,0,1,1,0,1,0,4,0,1,0,1,0,1,1,0,1,1,//2041
0,1,0,0,1,0,0,1,1,0,1,1,1,0,1,0,0,1,2,1,0,1,1,1,
1,0,1,0,0,1,0,0,1,0,1,1,1,0,1,0,1,0,1,0,0,1,0,1,
1,0,1,1,3,0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,0,0,1,0,
1,0,1,0,1,1,0,1,1,0,1,0,0,1,3,0,1,0,1,1,0,1,1,0,54779)
const ms=new Array(m0,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14);
const ly=new Array(29,30,58,59,59,60);
const tw=new Array(0,0,1,1,2,2,3,3,4,4);
const dw=new Array(4,2,0,0,2,1,1,2,3,3,2,4);



const acientBirth = {
  inq(time){
    // console.log(time);
    var form = {}
    if(time){
      form.y = parseInt(moment(time).format('YYYY'))
      form.m = parseInt(moment(time).format('MM'))
      form.d = parseInt(moment(time).format('DD'))
      form.h = parseInt(moment(time).format('hh'))

    }

   var re="请重新输入！";
   var reback = ''
   var y=form.y;
   if (y==""||y<1901||y>2050) alert("年应在1901和2050之间。"+re);
   else{
    var gl0=(Date.UTC(y,0,1)-Date.UTC(1901,1,19))/86400000;
    var dy = y-1901;
    var i=Math.floor(dy/10);
    var nl0=(i==0)?0:ms[i-1][120];
    var n=i*120;
    for (var j=0;j<120;j++){
     n++;
     if (n>dy*12) break;
     nl0+=ly[ms[i][j]];
    }
    var cjr=(nl0-gl0)%31+1;
    var cjy=(nl0-gl0>30)?2:1;
    var jq=tg[(dy+6)%10]+dz[dy%12];
    var jh=tg[(dy+7)%10]+dz[(dy+1)%12];
    var s1="公历："+y+"年";
    var s2="<br>春节："+cjy+"月"+cjr+"日<br>节前："+jq+"年<br>节后："+jh+"年<br>";
    var s3="查询生辰八字，请输入时。";
    var s4="</td></tr></table></center></body>";
    var m=form.m;
    var d=form.d;
    var h=form.h;
    if (m==""||d==""){
     return reback = {
       CC:s1
     };
    //  document.close();
    }
    else if (m>12||m<1)
     alert("月应在1与12之间。"+re);
    else if (d>31||d<1)
     alert("日应在1与31之间。"+re);
    else if ((m==4||m==6||m==9||m==11)&&d>30)
     alert(m+"月只有30天。"+re);
    else if (y%4!=0&&m==2&&d>28)
     alert(y+"年是平年，2月只有28天。"+re);
    else if (m==2&&d>29)
     alert(y+"年是闰年，2月只有29天。"+re);
    else if (h>23||h<0)
     alert("时应在0与23之间。"+re);
    else{
     if (form.h=="") h=0;
     var sum=(Date.UTC(y,m-1,d,h)-Date.UTC(1901,1,18,23))/1000;
     var sumd=Math.floor(sum/86400);
     var day=(Math.floor((sum-1800)/86400)+51)%7;
     var xq=(day==0)?"日":sz[day-1];
     var tgr=(sumd+54)%10;
     var dzr=(sumd+52)%12;
     var gzr=tg[tgr]+dz[dzr];
     var dzs=Math.floor((h*1+1)/2)%12;
     var tgs=((tgr%5)*2+dzs)%10;
     var gzs=tg[tgs]+dz[dzs];
     for (var i=0;ms[i][120]<=sumd;i++);
     var k=(i==0)?0:ms[i-1][120];
     var p=i*120;
     for (var j=0;j<120;j++){
      //  debugger
        k+=ly[ms[i][j]];
        p++;
        if (k>sumd && ri<=30){
          break;
        };

        if (sumd+30<0){
          var ri = 59+sumd;
          p=-1;
        }
        else if (sumd<0){
          var ri=30+sumd;
          p=0;
        }
       else{
         var ri=sumd+ly[ms[i][j]]-k;
         var yue=((p+11)%12==0)?"正":sz[(p+11)%12];
         var mij=ms[i][j];
         if ((mij==2||mij==3)&&ri>28){
          ri-=29;
          yue="闰"+yue;
         }
         else if ((mij==4||mij==5)&&ri>29){
          ri-=30;
          yue="闰"+yue;
         }
       }

     }
    //  debugger
    //  console.log(ri);
    ri= ((ri<10)?"初":"") + sz[ri];
    var tgn=Math.floor((p-1)/12+7)%10;
    var dzn=Math.floor((p-1)/12+1)%12;
    var  gzn=tg[tgn]+dz[dzn];
    var tgy=(p+5)%10;
    var dzy=(p+1)%12;
    var gzy=tg[tgy]+dz[dzy];
    var  tn=tw[tgn];
    var  dn=dw[dzn];
    var ty=tw[tgy];
    var  dy=dw[dzy];
    var  tr=tw[tgr];
    var  dr=dw[dzr];
    var  ts=tw[tgs];
    var ds=dw[dzs];
    var  s5=m+"月"+d+"日（星期"+xq+"）";
    var  s6=gzn+"年"+yue+"月"+ri+"日";
    var  s7="生肖："+sx[dzn]+"<p>"
     if (form.h=="")
      return reback = {
        CC:s1+s5,
        TC:s6
      }
      // return reback = s1+s5+s6+s2+"干支："+gzn+"年"+gzy+"月"+gzr+"日<br>"+s7+s3+s4;
     else
       return reback = {
         CC:s1+s5+h+"点",
         TC:s6+dz[dzs]+"时"
       }
      // return reback = s1+s5+h+"点"+s6+dz[dzs]+"时"+s2+
      // "八字："+gzn+"　"+gzy+"　"+gzr+"　"+gzs+"<br>"+
      // "五行："+w[tn]+w[dn]+"　"+w[ty]+w[dy]+"　"+w[tr]+w[dr]+"　"+w[ts]+w[ds]+"<br>"+
      // "方位："+f[tn]+f[dn]+"　"+f[ty]+f[dy]+"　"+f[tr]+f[dr]+"　"+f[ts]+f[ds]+"<br>"+s7+s4;
    //  document.close();
    }
   }
  }

}

export default acientBirth;
